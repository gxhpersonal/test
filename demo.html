<!doctype html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="apple-itunes-app" content="app-id=995915747, app-argument=huizuche://">
    <title>this's a demo</title>
    <meta id="viewport" name="viewport"
        content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <script>
        //屏幕适应 
        (function (win, doc) {
            if (!win.addEventListener) return;
            var html = document.documentElement;
            function setFont() {
                var html = document.documentElement;
                var k = 750;
                var clientW = html.clientWidth > 750 ? 750 : html.clientWidth;
                html.style.fontSize = clientW / k * 100 + "px";
            }
            setFont();
            setTimeout(function () {
                setFont();
            }, 300);
            doc.addEventListener('DOMContentLoaded', setFont, false);
            win.addEventListener('resize', setFont, false);
            win.addEventListener('load', setFont, false);
        })(window, document);
    </script>
</head>
<style>
    .oval-wrap {
        width: 50%;
        height: 20px;
        text-align: center;
    }

    .new-input {
        outline: none;
        border-radius: 0;
        border: 0;
        /* -webkit-appearance: none; */
    }

    .module {
        position: relative;
    }

    .module .img-box {
        display: -webkit-flex;
        display: -moz-box;
        display: -ms-flexbox;
        display: flex;
        padding: 0 .2rem;
        -webkit-justify-content: space-between;
        -moz-box-pack: justify;
        -ms-flex-pack: justify;
        justify-content: space-between;
        margin-top: .32rem;
        padding-bottom: .6rem;
    }

    .module img {
        width: 3.49rem;
        display: block;
        font-size: .24rem;
    }
</style>

<body>
    <!-- <div>
        <img class="vue-icon" width="50%" src="https://cn.vuejs.org/images/logo.png" alt="">
        <div class="oval-wrap">
            <div class="oval"></div>
        </div>
    </div>
    <div>
        <img class="circle" src="./img/timg.png" alt="">
    </div> -->
    <input class="new-input" type="text" placeholder="输入信息">

    <a href="huizuche://" data-android-href="http://a.app.qq.com/o/simple.jsp?pkgname=com.huizuche.app"
        data-ios-href="https://itunes.apple.com/cn/app/id995915747" class='open-btn'>免费下载</a>

    <a href="/test/test.html" class="open">去新的测试页面</a>
    <div>
        <a href="huizuche://splash.app?openType=H5&url=https://m.baidu.com" class="label">立即打开android&gt;&gt;</a>
    </div>
    <div>
        <a href="huizuche://?openType=H5&url=https://m.baidu.com" class="label">立即打开android没有host&gt;&gt;</a>
    </div>
    <div>
        <a href="huizuche://" class="label">立即打开ios&gt;&gt;</a>
    </div>

    <div class="count">0</div>

    <div class="module">
        <h3><span>美国 UNITED STATES</span></h3>
        <p>租满5天首日0元</p>
        <div class="img-box">
            <img src="https://cdn-aliyun-h5css.huizuche.com/Content/Images/Amex/promotion/MG-1.png" alt="">
            <img src="https://cdn-aliyun-h5css.huizuche.com/Content/Images/Amex/promotion/MG-2.png" alt="">
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-1.11.3.js"></script>
    <script>
        // 下载游戏或则打开app
        $('.open-btn').on('click', function () {
            let href = "";
            if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
                href = $('.open-btn').attr('data-ios-href');
            } else {
                href = $('.open-btn').attr('data-android-href');
            }
            let clickedAt = +new Date();
            setTimeout(function () {
                // webkitHidden检测页面对于用户的可见性(切换标签或者切换后台就不可见了)
                !window.document.webkitHidden && setTimeout(function () {
                    if (+new Date() - clickedAt < 2000) {
                        window.location = href;
                    }
                }, 500);
            }, 500)
        })

        //指定链接提示跳转/下载APP
        function getParameterByName(name, queryString) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            if (!queryString) {
                queryString = location.search;
            }
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(queryString);
            return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }
        var isOpen = getParameterByName("openapp") === "yes";
        var isDown = getParameterByName("downapp") === "yes";
        var timeout;
        function openAndDown() {
            var dates = Date.now();
            if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
                window.location = "huizuche://?openType=H5&url=" + location.href;
                timeout = setTimeout(function () {
                    if (Date.now() - dates < 1800) {
                        window.location = 'https://itunes.apple.com/cn/app/id995915747';
                    }
                }, 1500);
            } else if (navigator.userAgent.match(/android/i)) {
                window.location = "huizuche://?openType=H5&url=" + location.href;
                timeout = setTimeout(function () {
                    if (Date.now() - dates < 1800) {
                        window.location = 'http://a.app.qq.com/o/simple.jsp?pkgname=com.huizuche.app';
                    }
                }, 1500);
            }
            console.log(123)
        }

        if (isOpen && isDown) {
            setTimeout(openAndDown, 5000)
        } else if (isOpen && !isDown) {
            setTimeout(function () {
                if (location.pathname == "/") {
                    window.location = "huizuche://";
                } else {
                    window.location = "huizuche://?openType=H5&url=" + encodeURIComponent("http://m.huizuche.com/Car/List?pl=LAX&rl=LAX&pt=2018-06-02T10:00:00&rt=2018-06-09T10:00:00&sort=1&countryid=66&cityid=347");
                }
                console.log(456)
            }, 5000)

        } else if (!isOpen && isDown) {
            setTimeout(function () {
                if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
                    window.location = 'https://itunes.apple.com/cn/app/id995915747';
                } else if (navigator.userAgent.match(/android/i)) {
                    window.location = 'http://a.app.qq.com/o/simple.jsp?pkgname=com.huizuche.app';
                }
                console.log(789)
            }, 2000)
        }

        // w = function (e) {
        //     return m.commonChecks.isIOS ? m.commonChecks.isWeixin ? e.weixin.iOS : e.web.iOS : m.commonChecks.isWeixin ? e.weixin.Android : e.web.Android
        // }

        // h = function (link, n) {
        //     location.href = link;
        //     var o = w(n)
        //         , i = Date.now()
        //         , t = setTimeout(function () {
        //             Date.now() - i < 1800 && (location.href = o)
        //         }, 1500);
        //     return window.onpagehide = function () {
        //         clearTimeout(t)
        //     }
        //         ,
        //         document.addEventListener("visibilitychange", function () {
        //             var hide = document.hidden || document.webkitHidden;
        //             hide ? clearTimeout(t) : ""
        //         }, !1),
        //         !1
        // }


    // var timeout;

    // function openApp() {
    //     window.location = "huizuche://openType=H5&url=";
    //     timeout = setTimeout(function () {
    //         window.location = 'https://itunes.apple.com/cn/app/id995915747';
    //     }, 1000);
    // }
    // openApp()
    // //setTimeout(openApp, 1000);



        // if (navigator.userAgent.match(/(iPhone|iPod|iPad);?/i)) {
        //     var loadDateTime = new Date();
        //     window.setTimeout(function () {
        //         var timeOutDateTime = new Date();
        //         if (timeOutDateTime - loadDateTime < 5000) {
        //             // window.location.href = "https://itunes.apple.com/cn/app/id995915747";
        //             window.location = "http://a.app.qq.com/o/simple.jsp?pkgname=com.huizuche.app"
        //         } else {
        //             window.close();
        //         }
        //     }, 2000);
        //     window.location = "huizuche://";
        // } else if (navigator.userAgent.match(/android/i)) {
        //     var state = null;
        //     try {
        //         state = window.open("http://a.app.qq.com/o/simple.jsp?pkgname=com.huizuche.app", '_blank');
        //     } catch (e) { }
        //     if (state) {
        //         window.close();
        //     } else {
        //         window.location = "huizuche://";
        //     }
        // }

        // var loadDateTime = new Date();
        // window.setTimeout(function () {
        //     var timeOutDateTime = new Date();
        //     if (timeOutDateTime - loadDateTime < 5000) {
        //         console.log(timeOutDateTime - loadDateTime)
        //         window.location = "https://itunes.apple.com/cn/app/id995915747";//ios下载地址  
        //     } else {
        //         window.close();
        //     }
        // }, 2000);



        // var ua = navigator.userAgent.toLowerCase();
        // var t;
        // var config = {
        //     /*scheme:必须*/
        //     scheme_IOS: 'huizuche://',
        //     scheme_Adr: 'huizuche://',
        //     timeout: 600
        // };

        // // 通过iframe的方式试图打开APP，如果能正常打开，会直接切换到APP，并自动阻止js其他行为

        // var ifr = document.createElement('iframe');
        // ifr.src = 'huizuche://';//打开app的协议，有app同事提供
        // ifr.style.display = 'none';
        // document.body.appendChild(ifr);

        // // window.location.href = 'huizuche://';
        // window.setTimeout(function () {
        //     document.body.removeChild(ifr);
        //     window.location.href = "https://itunes.apple.com/cn/app/id995915747";
        // }, 2000)

    </script>
</body>

</html>